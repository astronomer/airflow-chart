---
suite: Test Security Context Constraints
templates:
  - templates/airflow-scc-anyuid.yaml
tests:
  - it: Should not be created by default
    asserts:
      - hasDocuments:
          count: 0
  - it: Should be created with configuration enabled
    set:
      airflow:
        scheduler:
          serviceAccount:
            create: true
            name: mockName
        webserver:
          serviceAccount:
            create: true
            name: mockName
        worker:
          serviceAccount:
            create: true
            name: mockName
      sccEnabled: true

    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: SecurityContextConstraints
